buildscript {
    repositories {
        mavenCentral()
        jcenter()
    }
}
plugins {
    id 'base'
    id 'com.moowork.node' version '1.2.0'
}

node {
    version = '10.5.0'
    download = true
}

task webpack(type: NodeTask, dependsOn: 'npmInstall') {
    inputs.file("package-lock.json") 
    inputs.file("webpack.config.js") 
    inputs.dir("src")

    outputs.dir("build")

    def osName = System.getProperty("os.name").toLowerCase();
    if (osName.contains("windows")) {
        script = project.file('node_modules/webpack/bin/webpack.js')
    } else {
        script = project.file('node_modules/.bin/webpack')
    }
}

build.dependsOn 'webpack'
clean.delete 'build'
